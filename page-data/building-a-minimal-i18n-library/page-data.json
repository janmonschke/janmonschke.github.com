{"componentChunkName":"component---src-templates-blog-post-js","path":"/building-a-minimal-i18n-library","result":{"data":{"site":{"siteMetadata":{"title":"Jan Monschke","author":"Jan Monschke"}},"markdownRemark":{"id":"6b6dd2e1-2c8c-5f18-8b5b-f7346ade4f90","excerpt":"I am currently building the website for my wedding next year which has to be translated into English, German and French to make the information accessible for‚Ä¶","html":"<p>I am currently building the website for <a href=\"https://twitter.com/thedeftone/status/1034480375781830656\">my wedding next year</a> which has to be translated into English, German and French to make the information accessible for all our guests.</p>\n<p>From work I know about the significance of internationalization (i18n) but also about the complexity of the topic. Which is why I started to look for libraries that were lightweight and easy to use. I quickly found myself in a deep rabbit hole, comparing the feature set of the big libraries like <a href=\"https://formatjs.io/\">Format.js</a>, <a href=\"https://github.com/i18next/i18next\">i18next</a> and small ones like <a href=\"https://github.com/airbnb/polyglot.js\">polyglot.js</a>. <code class=\"language-text\">Format.js</code> would be my go-to solution for a production app but I found that its setup and the translation format would be overkill for my tiny website. The same was true for <code class=\"language-text\">i18next</code>. Even <code class=\"language-text\">polyglot.js</code> offered too much functionality (e.g. support for all kinds of pluralizations that I knew I did not have to support) for what I needed.</p>\n<p>At that point I took a step back and began to formulate the structure for an i18n library that would suit my minimal requirements. What I essentially needed was a function that, when given a translation key, would return a string translated in the users language.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bus_tickets'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// => Your bus tickets</span></code></pre></div>\n<h2>Detecting the user‚Äôs language</h2>\n<p>This raised the question: how do I detect the user‚Äôs desired language. I knew about the <a href=\"https://developer.mozilla.org/docs/Web/HTTP/Headers/Accept-Language\">Accept-Language HTTP header</a> but since my website does not have a server, I was not able to use that header so I used <a href=\"https://developer.mozilla.org/docs/Web/API/NavigatorLanguage/language\">navigator.language</a> which returns the language that the browser is set to.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> defaultLocale <span class=\"token operator\">=</span> <span class=\"token string\">'en'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> userLocale <span class=\"token operator\">=</span>\n  navigator<span class=\"token punctuation\">.</span>language <span class=\"token operator\">||</span> navigator<span class=\"token punctuation\">.</span>userLanguage <span class=\"token operator\">||</span> navigator<span class=\"token punctuation\">.</span>browserLanguage<span class=\"token punctuation\">;</span></code></pre></div>\n<p>The next step was to match the the user‚Äôs language to one of the languages that I was translating, or, if the user‚Äôs language was not supported, to fall back to the default locale. The matching is kept simple here on purpose because the locales that I would support are pretty simple. I was also not planning on adding special translations in cases like <code class=\"language-text\">de_AT</code> (Austrian German) or <code class=\"language-text\">fr_CA</code> (French Canadian). (If you‚Äôre planning on localizing your product‚Äôs website, you should definitely consider adding support for those locales!)</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> supportedLocales <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>defaultLocale<span class=\"token punctuation\">,</span> <span class=\"token string\">'de'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'fr'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getSupportedLocale</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">supported<span class=\"token punctuation\">,</span> userLocale<span class=\"token punctuation\">,</span> fallback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// simple string match of the locale</span>\n  <span class=\"token keyword\">const</span> locale <span class=\"token operator\">=</span> supported<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">loc</span> <span class=\"token operator\">=></span>\n    userLocale<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span>loc<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> locale <span class=\"token operator\">||</span> fallback<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> locale <span class=\"token operator\">=</span> <span class=\"token function\">getSupportedLocale</span><span class=\"token punctuation\">(</span>supportedLocales<span class=\"token punctuation\">,</span> userLocale<span class=\"token punctuation\">,</span> defaultLocale<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>Getting static translations</h2>\n<p>Great, now we have the user‚Äôs locale! In order to get a translated string, we now have to set up a data structure for our translations. The structure that I selected does purposely not adhere to a standard like the gettext format (<a href=\"https://www.gnu.org/software/gettext/manual/html_node/PO-Files.html\">PO files</a>) or the <a href=\"http://userguide.icu-project.org/formatparse/messages\">ICU message format</a>. Those formats are great, but I did not want to integrate a parser or a runtime for my translation system. (Again, if you build a real product, you should use those formats, I can‚Äôt stress that enough üòÖ).</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> translations <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">bus_tickets</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">en</span><span class=\"token operator\">:</span> <span class=\"token string\">'Your bus tickets'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">de</span><span class=\"token operator\">:</span> <span class=\"token string\">'Deine Bustickets'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">fr</span><span class=\"token operator\">:</span> <span class=\"token string\">'Tes billets pour le bus'</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The only thing missing to get translated strings is the translation function itself. That function takes the user‚Äôs locale and looks up the translation from our <code class=\"language-text\">translations</code> object.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">translationKey</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> translations <span class=\"token operator\">=</span> strings<span class=\"token punctuation\">[</span>translationKey<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>translations<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// The translation in the user's locale</span>\n    <span class=\"token keyword\">const</span> localized <span class=\"token operator\">=</span> translations<span class=\"token punctuation\">[</span>userLocale<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// The translation in the default locale</span>\n    <span class=\"token keyword\">const</span> defaultString <span class=\"token operator\">=</span> translations<span class=\"token punctuation\">[</span>defaultLocale<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>localized<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> localized<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>defaultString<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> defaultString<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>If I would only have to support static strings, this is where I could have stopped üéâ Our website however does have interactive elements so I had to add support for interpolated strings.</p>\n<h2>Interpolated strings</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'singed_in_as'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token string\">'your@email.com'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// => Signed in as: your@email.com</span></code></pre></div>\n<p>To keep things simple, I used JavaScript <a href=\"https://developer.mozilla.org/docs/Web/JavaScript/Reference/Template_literals\">template literals</a> for interpolation which from a developer‚Äôs perspective is pretty neat, but from a security perspective is pretty bad since it might allow for <a href=\"https://en.wikipedia.org/wiki/Cross-site_scripting\">XSS attacks</a> if not used correctly. I debated the risk and came to the conclusion that the risk is very low in my case since I am rendering the translations as children of React nodes, which does have XSS protection built in.</p>\n<p>Leveraging functionality of template literals, interpolated strings are defined as follows in my translations object:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> translations <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">signed_in_as</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">en</span><span class=\"token operator\">:</span> <span class=\"token parameter\">user</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Signed in as: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>user<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">de</span><span class=\"token operator\">:</span> <span class=\"token parameter\">user</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Eingeloggt als: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>user<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">fr</span><span class=\"token operator\">:</span> <span class=\"token parameter\">user</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Connect√© en tant que: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>user<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>Plurals</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'bus_tickets_booked'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// => You have booked 2 tickets</span></code></pre></div>\n<p>Adding support for pluralization was a bit more tricky than adding interpolations because it requires you to take the pluralization rules of each language into account. In English and German for example you use the singular form when the quantity is exactly one and then you use the plural form for zero quantiries and for quantities that are bigger than one. However, different rules apply for French. There you use the singular form for quantities of zero and one and then the plural for everything that is more than one.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> translations <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">bus_tickets_booked</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">en</span><span class=\"token operator\">:</span> <span class=\"token function\">pluralize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">'You have booked one ticket'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token parameter\">num</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">You have booked </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>num<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> tickets</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token literal-property property\">fr</span><span class=\"token operator\">:</span> <span class=\"token function\">pluralize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n      <span class=\"token parameter\">num</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Tu as r√©serv√© </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>num<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> ticket</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token parameter\">num</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Tu as r√©serv√© </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>num<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> tickets</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Translations that require pluralization, are wrapped with the <code class=\"language-text\">pluralize</code> helper that selects the correct plural/singular form for the user‚Äôs language.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">indexEN</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> num <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">indexFR</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> num <span class=\"token operator\">></span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token number\">1</span> <span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> pluralIndex <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">en</span><span class=\"token operator\">:</span> indexEN<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">de</span><span class=\"token operator\">:</span> indexEN<span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">fr</span><span class=\"token operator\">:</span> indexFR\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">pluralize</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">translationArr</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> index <span class=\"token operator\">=</span> pluralIndex<span class=\"token punctuation\">[</span>locale<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> translationFn <span class=\"token operator\">=</span> translationArr<span class=\"token punctuation\">[</span>index<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">translationFn</span><span class=\"token punctuation\">.</span><span class=\"token function\">apply</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">pluralize</code> <a href=\"https://en.wikipedia.org/wiki/Currying\">curries</a> the actual translation interpolation function. It selects the correct index function for the current locale and then returns the translation index.</p>\n<p>The concept of selecting the index of a translation array, is not a concept that I came up with but that is very common for translation libraries. The rules for these indices can be looked up in the <a href=\"https://www.unicode.org/cldr/charts/34/supplemental/language_plural_rules.html\">CLDR pluralization rules documentation</a>.</p>\n<p>In my case I only have to support English, German and French that all have only two cases: singular and plural. If we would have to support Russian or Arabic, I‚Äôd have to provide more translation for different cases of plurals. Russian for example has four cases: singular, few, many and other. Adding support for a new language would only require providing a new index selector for that language.</p>\n<h2>Setting the locale</h2>\n<p>Now that static translations, interpolations and plurals are implemented, the only thing that was missing was to allow the user to select a preferred locale. This is an absolute requirement for translated websites. When we were parsing the user‚Äôs language, we were just making an informed guess as to which language they might prefer. We don‚Äôt know if the user would actually prefer to read our website in English, even though their browser language is set to French and we should let them decide.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">setLocale</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">newLocale</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  locale <span class=\"token operator\">=</span> newLocale<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">setItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'locale'</span><span class=\"token punctuation\">,</span> newLocale<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The solution for this is to add a language selector to your page that either sets a cookie or that stores the selected locale in <code class=\"language-text\">localStorage</code> so that you can read out the user‚Äôs preference when deciding which language to render. That only adds a couple of lines to our initial guess of the userLocale:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">getStoredLocale</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// try getting the locale from local storage</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> localStorage<span class=\"token punctuation\">.</span><span class=\"token function\">getItem</span><span class=\"token punctuation\">(</span><span class=\"token string\">'locale'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> userLocale <span class=\"token operator\">=</span>\n  <span class=\"token function\">getStoredLocale</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span>\n  navigator<span class=\"token punctuation\">.</span>language <span class=\"token operator\">||</span>\n  navigator<span class=\"token punctuation\">.</span>userLanguage <span class=\"token operator\">||</span>\n  navigator<span class=\"token punctuation\">.</span>browserLanguage<span class=\"token punctuation\">;</span></code></pre></div>\n<h2>How to use the library</h2>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> t <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./translations'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">SignInInfo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> user <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Fragment</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token function\">t</span><span class=\"token punctuation\">(</span><span class=\"token string\">'signed_in_as'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>signIn<span class=\"token punctuation\">.</span>email<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">SignOutButton</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Fragment</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>In order to use translations in your views, simply call the <code class=\"language-text\">t</code> function with your translation key and, if required, additional parameters for interpolation or pluralization.</p>\n<p>You can use the library with any JavaScript framework that you like. In my case it‚Äôs <code class=\"language-text\">React</code>, but it would work just as good with <code class=\"language-text\">Vue.js</code>, <code class=\"language-text\">Angular</code> or whichever hto new JS framework there is these days (<code class=\"language-text\">Backbone</code> anyone? üòâ).</p>\n<p>Check out this <a href=\"https://glitch.com/~minimal-i18n-library\">Glitch project</a> for an example project and find the code on GitHub: <a href=\"https://github.com/janmonschke/minimal-i18n\">https://github.com/janmonschke/minimal-i18n</a>.</p>\n<h2>Wrapping up</h2>\n<p>Did I save time by skipping the setup of one of the established i18n libraries by writing my own library? Most probably not üòÑ! But I did learn a lot about internationalization in general and feel like I have a lot more empathy now with users that use translated products and that have to deal with wrong translations constantly. I feel like I will pay a lot more attention to how I use translations at work now.</p>\n<p>Once more: the library was only built for a tiny website and mainly for educational purposes so please don‚Äôt use it in your production projects. Depending on how you use the library, it‚Äôs a potential source for XSS attacks and there are plenty of basic features that it does not support yet (e.g. multiple plurals in a single sentence).</p>","frontmatter":{"title":"Building a minimal i18n library","type":"blog","date":"June 10, 2019","pomodoros":8,"keywords":["JavaScript","i18n","library","tutorial"],"image":null}},"webmentions":{"edges":[]},"likes":{"edges":[{"node":{"author":{"name":"Minh Nguyen","photo":"https://webmention.io/avatar/pbs.twimg.com/a653a2bd7558e00e807f966bba14a7dd90624d95150425b20cc168bc62dc73a9.jpg","url":"https://twitter.com/minh_ngvyen"},"id":"911d0f32-de70-5a7a-9acc-9088e23b4773"}},{"node":{"author":{"name":"chrisguttandin","photo":"https://webmention.io/avatar/abs.twimg.com/0e6b2cd70aa5b35dec24ca4e1e63f8963f0118736d9ec3bba77e3a8c99a27bc2.png","url":"https://twitter.com/chrisguttandin"},"id":"98e5b9d7-9d28-569a-b541-6e1006d1878b"}},{"node":{"author":{"name":"stefffi","photo":"https://webmention.io/avatar/pbs.twimg.com/e312c3203e281782c111d81392cd9d29ac219ccd0d0b2274c9de75aa84a4645c.jpg","url":"https://twitter.com/Stefffi"},"id":"aa54e056-a72a-5606-9709-41788c0f6843"}},{"node":{"author":{"name":"Nik Graf","photo":"https://webmention.io/avatar/pbs.twimg.com/018330167f93b3c0f6d8e48e11011716c74996a281e42da1146e9aaf87cc96dd.jpg","url":"https://twitter.com/nikgraf"},"id":"5e569fe6-3817-55f8-9aa4-0a03fc24b127"}},{"node":{"author":{"name":"@benschwarz@front-end.social","photo":"https://webmention.io/avatar/pbs.twimg.com/5de7c3471353ac450ca2b0dbeb7c3d947bb1617aad68ef2537c533ef10e05d7e.jpg","url":"https://twitter.com/benschwarz"},"id":"f30a73a5-14e7-55ec-8f10-c218fe306e39"}},{"node":{"author":{"name":"J√∫lio Zynger","photo":"https://webmention.io/avatar/pbs.twimg.com/a9be9ed5bbfdea6a2a127f8db592a91dec27c7dd83113d86cf84c9dbef19a031.jpg","url":"https://twitter.com/juliozynger"},"id":"03bfce01-4c19-5c86-b194-db1bafeed1fd"}},{"node":{"author":{"name":"Nitin","photo":"https://webmention.io/avatar/pbs.twimg.com/f3f30edb0de3cad17771efdb2a1586a2113bc8acc456030611fc95210abdd250.jpg","url":"https://twitter.com/NTulswani"},"id":"dbeb36d2-f5ea-5fa2-bbe3-17781cc4020f"}},{"node":{"author":{"name":"Can G√∂ktas","photo":"https://webmention.io/avatar/pbs.twimg.com/0eb9ec6434a2f51db1d1c51e8b6ccb0f6ca17c6f6cc70059325b5df4a951f0d5.jpg","url":"https://twitter.com/cangoektas"},"id":"0bd048ba-defb-5101-8413-0c6cd71682b0"}},{"node":{"author":{"name":"litenjacob","photo":"https://webmention.io/avatar/pbs.twimg.com/757964d6e2df9827c8caf61ef495fc59999011c243ac44fb07921653ac87c840.jpg","url":"https://twitter.com/litenjacob"},"id":"539ea664-b74a-587a-8f01-69477f522118"}},{"node":{"author":{"name":"Robin B√∂hm (he/him)","photo":"https://webmention.io/avatar/pbs.twimg.com/8ed8d7a99174a58575850919c145f8175cb8871ebe716eb17ae587ff0b10022d.jpg","url":"https://twitter.com/robinboehm"},"id":"4751e9d1-1c45-59aa-bbb8-d400e5dd2646"}},{"node":{"author":{"name":"Jane/JeongEun Lee","photo":"https://webmention.io/avatar/pbs.twimg.com/df3ba5987869365d8775ce90a15f00d61e0cffa025fc68c0e25793a9ff02d4f1.jpg","url":"https://twitter.com/snooje"},"id":"7464db14-0b05-561a-a8f8-6aa1b0662085"}},{"node":{"author":{"name":"Ben Stahl","photo":"https://webmention.io/avatar/pbs.twimg.com/f32e70815b303c0ac03b68f2318ae4078eef7a1263a3dfce7f842d4fb230e3ed.jpg","url":"https://twitter.com/bhstahl"},"id":"0838262a-a935-5d08-8dac-152fb989d6c6"}},{"node":{"author":{"name":"Sona/Soeun Lee","photo":"https://webmention.io/avatar/pbs.twimg.com/acca9bf92bfb627bf2cd85ff287fa60c7c062c6b32aaad965984c64655f868a1.jpg","url":"https://twitter.com/mojosoeun"},"id":"1b19ccb8-fa21-5341-85a5-8a86f1e3f4f0"}},{"node":{"author":{"name":"andreea salinca","photo":"https://webmention.io/avatar/pbs.twimg.com/36b6a81ab0d2435e341d891078fc8a2f003ebeff33b2cb3d6be070e415cd3176.jpg","url":"https://twitter.com/andreea_salinca"},"id":"ab2d9ddc-56bf-55cb-ac6f-5aae65f60fee"}},{"node":{"author":{"name":"Ji Young","photo":"https://webmention.io/avatar/pbs.twimg.com/b2f5b61f0d8fedcd044391791f444a178ea0c60cb68f2bb21a8b710d567ec940.jpg","url":"https://twitter.com/jyhwng"},"id":"dbb45246-48d2-591d-91a4-b6b4f29bd4f5"}},{"node":{"author":{"name":"M√°rton Salomv√°ry","photo":"https://webmention.io/avatar/pbs.twimg.com/160bac451ef53cd3827333a02129ee81c2041147ca4efdf65c1201b373fadf3b.jpg","url":"https://twitter.com/salomvary"},"id":"2493dde9-0bb0-5218-b905-6a80c32408c8"}},{"node":{"author":{"name":"Nobuhide Yayoshi","photo":"https://webmention.io/avatar/pbs.twimg.com/33b0b6f3fce23d5680647983b0e00e2b49d9a7f2d52d3fb9c35297d244942a90.jpg","url":"https://twitter.com/yayoc_"},"id":"7086ac19-5417-5f39-ab77-02421aeb4d98"}},{"node":{"author":{"name":"Georgios Giannoutsos Barkas","photo":"https://webmention.io/avatar/pbs.twimg.com/935e4c744dc7e4920e0e8643523dbf335a417a6162a7c8fd2564dcdae9798472.jpg","url":"https://twitter.com/nuc"},"id":"75abe214-8d7b-5214-9a53-85316a738d1d"}},{"node":{"author":{"name":"ü§ñhÃ∑aÃ∑yÃ∑wÃ∑iÃ∑rÃ∑eÃ∑zÃ∂üê•","photo":"https://webmention.io/avatar/pbs.twimg.com/7a7d03659ef282635edf51e97e1708b0095eba5bacc355742a10c17aadf9da2d.jpg","url":"https://twitter.com/haywirez"},"id":"9f1052d3-631e-5aea-b5ff-a13548c7553f"}},{"node":{"author":{"name":"Kahlil Lechelt","photo":"https://webmention.io/avatar/pbs.twimg.com/90aac90d7ef77586d0717125fcc9eb6cd8948fee38511001759f92c9f57e5f4e.jpg","url":"https://twitter.com/kahliltweets"},"id":"98526f8f-057c-514f-8fee-0f0c0aaceb7e"}}]}},"pageContext":{"slug":"/building-a-minimal-i18n-library","publicUrl":"https://janmonschke.com/building-a-minimal-i18n-library/","previous":{"fields":{"slug":"/blog/2015/01/14/simulations-in-javascript.html"},"frontmatter":{"title":"Simulations in JavaScript","type":"blog"}},"next":{"fields":{"slug":"/garbage-collection-in-redux-applications"},"frontmatter":{"title":"Garbage Collection in Redux Applications","type":"blog"}}}},"staticQueryHashes":["1677560032","3729604799"]}